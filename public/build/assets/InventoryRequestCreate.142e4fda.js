import{h as w,D as R,A as P,C as j,c,a as n,w as V,u as t,b as e,i as k,E as U,l as b,t as h,j as f,F as q,e as C,k as v,o as u,H as E,d as I,G as p,L as J,I as L,J as F}from"./app.efba5474.js";import{s as M}from"./multiselect.d899e918.js";import{_ as A,a as G}from"./Breadcrumb.fe2f7d4a.js";const O=e("title",null,"Inventory Product",-1),Q={class:"px-4 grid gap-4"},z={class:"grid"},K={class:"card w-full rounded-none border-2 border-info shadow-xl"},W={class:"card-body"},X={class:"grid grid-cols-4 gap-4"},Y={class:"form-control w-full"},Z=e("label",{class:"label"},[e("span",{class:"label-text"},"Tanggal")],-1),ee={class:"flex"},se=["value"],te={class:"form-control w-full"},oe=e("label",{class:"label"},[e("span",{class:"label-text"},"Supplier")],-1),ae=["disabled","value"],de={class:"form-control w-full"},re=e("label",{class:"label"},[e("span",{class:"label-text"},"Invoice Number")],-1),le=["disabled","value"],ne={class:"px-4 grid gap-4 mt-4"},ie={class:"grid"},ce={class:"card w-full rounded-none border-2 border-info shadow-xl"},ue={class:"card-body"},pe={class:"grid grid-cols-3 gap-4"},_e={class:"form-control w-full"},be=e("label",{class:"label"},[e("span",{class:"label-text"},"Total Pembayaran")],-1),he={class:"form-control w-full"},me=e("label",{class:"label"},[e("span",{class:"label-text"},"Jumlah Pembayaran")],-1),ye={class:"form-control w-full"},ge=e("label",{class:"label"},[e("span",{class:"label-text"},"Sisa Tagihan")],-1),fe={class:"card-actions justify-end mt-4"},ve={class:"px-4 grid gap-4 mt-4"},xe={class:"grid"},we={class:"card w-full rounded-none border-2 border-info shadow-xl"},Ve={class:"card-body"},ke={class:"min-w-full"},qe={class:"my-2"},Pe={key:0,class:"text-sm text-error"},Ue={key:1,class:"text-sm text-error"},Ce={key:2,class:"text-sm text-error"},Ie={class:"form-control w-full mb-4"},Fe=e("label",{class:"label"},[e("span",{class:"label-text text-2xl font-bold"},"Cari Produk (Barcode / Nama Produk)")],-1),Be={key:0,class:"w-full text-left text-base min-w-4xl"},De=e("thead",{class:"text-sm uppercase bg-primary/20"},[e("tr",null,[e("th",{class:"py-3 px-6"},"#"),e("th",{class:"py-3 px-6"},"Product"),e("th",{class:"py-3 px-6 w-32"},"Jumlah Beli"),e("th",{class:"py-3 px-6"},"Satuan"),e("th",{class:"py-3 px-6"},"Quantity Terkecil"),e("th",{class:"py-3 px-6"},"Harga Modal"),e("th",{class:"py-3 px-6"},"Total"),e("th",{class:"py-3 px-6"},"Hapus")])],-1),Ne={class:"hover:cursor-pointer group border-b"},Te={class:"group-hover:bg-base-300 py-2 px-4 text-sm"},$e={class:"group-hover:bg-base-300 py-2 px-4 text-sm"},He={class:"group-hover:bg-base-300 py-2 px-4"},Se={class:"group-hover:bg-base-300 py-2 px-4"},Re=["onUpdate:modelValue","onChange"],je=["value","selected"],Ee={class:"group-hover:bg-base-300 py-2 px-4"},Je={class:"group-hover:bg-base-300 py-2 px-4"},Le=["data-tip"],Me={class:"relative mt-1 rounded-md shadow-sm"},Ae={class:"group-hover:bg-base-300 py-2 px-4"},Ge={class:"group-hover:bg-base-300 py-2 px-4"},Oe=["onClick"],Xe={__name:"InventoryRequestCreate",props:{purchases:Object},setup(B){const l=B,D=[{url:route("app.index"),label:"Beranda"},{url:route("app.inventory.index"),label:"Inventory"},{url:null,label:"Inventory Product"}],o=w({product_price_id:[],product_price_quantity:[],quantity:[],buying_price:[],total:[]}),m=R({data:l.purchases}),y=w({id:""}),i=w({purchase_id:l.purchases.id,bill:"",payment:"",fund:""});P(()=>F.cloneDeep(y.id),(a,d)=>{a&&T(a)}),P(()=>F.cloneDeep(i),(a,d)=>{a&&(i.fund=a.bill-a.payment)});const N=async a=>(await v.post(route("app.request.get.product"),{search:a})).data.map(s=>({value:s.id,label:s.barcode.toUpperCase()+" - "+s.name.toUpperCase()})),T=async a=>{await v.post(route("app.inventory.request.product.add",l.purchases.id),{product_id:a}).then(d=>{m.data=d.data,g(d.data),y.reset(),y.defaults({id:""})})},$=async a=>{await v.delete(route("app.inventory.request.product.delete",a)).then(d=>{m.data=d.data,g(d.data)})},x=async a=>{let d={product_price_id:o.product_price_id[a],quantity:o.quantity[a],buying_price:o.buying_price[a]};await v.patch(route("app.inventory.request.product.update",a),d).then(s=>{m.data=s.data,g(s.data)})},H=()=>{i.delete(route("app.inventory.request.destroy",l.purchases.id))},g=a=>{a.details.forEach((s,_)=>{o.product_price_quantity[s.id]=s.product_price_quantity,o.product_price_id[s.id]=s.product_price_id,o.quantity[s.id]=s.quantity,o.buying_price[s.id]=s.buying_price,o.total[s.id]=s.total});let d=a.details.reduce((s,_)=>(s.push(_.total),s),[]);i.bill=d.reduce((s,_)=>s+=_,0)},S=a=>{let d=a.product.stocks[a.product.stocks.length-1];return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(d.buying_price)};return j(()=>{g(m.data)}),(a,d)=>(u(),c(q,null,[n(t(E),null,{default:V(()=>[O]),_:1}),n(G,{links:D}),n(A,{classes:"bg-base-content",class:""},{default:V(()=>[I("Inventory Product")]),_:1}),e("section",Q,[e("div",z,[e("div",K,[e("div",W,[e("div",X,[e("div",Y,[Z,e("div",ee,[e("input",{type:"date",disabled:"",value:l.purchases.invoice_date,class:"input input-bordered rounded-none w-full"},null,8,se)])]),e("div",te,[oe,e("input",{disabled:l.purchases,value:l.purchases.supplier_name,class:"input input-bordered rounded-none"},null,8,ae)]),e("div",de,[re,e("input",{disabled:l.purchases,value:l.purchases.invoice_number,class:"input input-bordered rounded-none"},null,8,le)]),e("div",{class:"form-control w-full"},[e("button",{type:"button",onClick:H,class:"mt-9 btn btn-error"},"Batalkan Transaksi")])])])])])]),k(e("section",ne,[e("div",ie,[e("div",ce,[e("div",ue,[e("div",pe,[e("div",_e,[be,n(t(p),b({disabled:"",modelValue:t(i).bill,"onUpdate:modelValue":d[0]||(d[0]=s=>t(i).bill=s)},{decimal:".",separator:",",prefix:"Rp ",masked:!1},{class:"input input-bordered rounded-none"}),null,16,["modelValue"])]),e("div",he,[me,n(t(p),b({modelValue:t(i).payment,"onUpdate:modelValue":d[1]||(d[1]=s=>t(i).payment=s)},t(p),{class:"input input-bordered rounded-none"}),null,16,["modelValue"])]),e("div",ye,[ge,n(t(p),b({modelValue:t(i).fund,"onUpdate:modelValue":d[2]||(d[2]=s=>t(i).fund=s)},t(p),{disabled:l.purchases,class:"input input-bordered rounded-none"}),null,16,["modelValue","disabled"])])]),e("div",fe,[n(t(J),{as:"button",href:a.route("app.inventory.request.show",l.purchases.id),class:"btn btn-primary"},{default:V(()=>[I("Preview Inventory")]),_:1},8,["href"])])])])])],512),[[U,l.purchases]]),k(e("section",ve,[e("div",xe,[e("div",we,[e("div",Ve,[e("div",ke,[e("div",qe,[t(o).errors.quantity?(u(),c("div",Pe,h(t(o).errors.quantity),1)):f("",!0),t(o).errors.product_price_id?(u(),c("div",Ue,h(t(o).errors.product_price_id),1)):f("",!0),t(o).errors.buying_price?(u(),c("div",Ce,h(t(o).errors.buying_price),1)):f("",!0)]),e("div",Ie,[Fe,n(t(M),{class:"select select-bordered rounded-none focus:ring-0","clear-on-select":!0,"clear-on-search":!0,modelValue:t(y).id,"onUpdate:modelValue":d[3]||(d[3]=s=>t(y).id=s),placeholder:"Cari Product (Barcode / Nama Produk)","filter-results":!1,"min-chars":3,"resolve-on-load":!1,delay:0,searchable:!0,options:async function(s){return await N(s)}},null,8,["modelValue","options"])]),t(o).product_price_id.length?(u(),c("table",Be,[De,e("tbody",null,[(u(!0),c(q,null,C(m.data.details,(s,_)=>(u(),c("tr",Ne,[e("td",Te,h(_+1),1),e("td",$e,h(s.product_name),1),e("td",He,[n(t(p),{modelValue:t(o).quantity[s.id],"onUpdate:modelValue":r=>t(o).quantity[s.id]=r,onFocusout:r=>x(s.id),class:"w-32 rounded-md border-gray-300 pl-8 pr-4 text-right focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},null,8,["modelValue","onUpdate:modelValue","onFocusout"])]),e("td",Se,[k(e("select",{"onUpdate:modelValue":r=>t(o).product_price_id[s.id]=r,onChange:r=>x(s.id),class:"mt-1 w-32 rounded-md border border-gray-300 bg-white py-2 px-3 shadow-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"},[(u(!0),c(q,null,C(s.product.prices,(r,Qe)=>(u(),c("option",{value:r.id,selected:s.product_price_id=r.id},h(r.unit.name),9,je))),256))],40,Re),[[L,t(o).product_price_id[s.id]]])]),e("td",Ee,[n(t(p),b({modelValue:t(o).product_price_quantity[s.id],"onUpdate:modelValue":r=>t(o).product_price_quantity[s.id]=r},{decimal:".",separator:",",suffix:" @ "+s.price.unit.name,masked:!1},{class:"w-32 rounded-md border-gray-300 pl-8 pr-4 text-right focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),null,16,["modelValue","onUpdate:modelValue"])]),e("td",Je,[e("div",{class:"tooltip tooltip-success tooltip-left","data-tip":"Harga beli terakhir "+S(s)},[e("div",Me,[n(t(p),b({modelValue:t(o).buying_price[s.id],"onUpdate:modelValue":r=>t(o).buying_price[s.id]=r},{decimal:".",separator:",",prefix:"Rp ",masked:!1},{onFocusout:r=>x(s.id),class:"w-48 rounded-md border-gray-300 pl-8 pr-4 text-right focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),null,16,["modelValue","onUpdate:modelValue","onFocusout"])])],8,Le)]),e("td",Ae,[n(t(p),b({modelValue:t(o).total[s.id],"onUpdate:modelValue":r=>t(o).total[s.id]=r},{decimal:".",separator:",",prefix:"Rp ",masked:!1},{class:"w-48 rounded-md border-gray-300 pl-8 pr-4 text-right focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"}),null,16,["modelValue","onUpdate:modelValue"])]),e("td",Ge,[e("button",{type:"button",onClick:r=>$(s.id),class:"inline-block rounded-lg bg-red-600 px-2 py-1 text-base font-semibold leading-7 text-white shadow-sm ring-1 ring-red-600 hover:bg-red-700 hover:ring-red-700"},"Hapus",8,Oe)])]))),256))])])):f("",!0)])])])])],512),[[U,l.purchases.details]])],64))}};export{Xe as default};
